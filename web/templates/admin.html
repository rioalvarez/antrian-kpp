<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Sistem Antrian</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1>Panel Admin Sistem Antrian</h1>
            <nav>
                <a href="/ticket" target="_blank">Ambil Antrian</a>
                <a href="/display" target="_blank">Display</a>
                <button class="btn btn-danger" onclick="showResetModal()">Reset Antrian</button>
            </nav>
        </header>

        <main class="admin-main">
            <section class="stats-section">
                <h2>Statistik Hari Ini</h2>
                <div class="stats-grid" id="stats">
                    <div class="stat-card">
                        <span class="stat-value" id="stat-total">0</span>
                        <span class="stat-label">Total Antrian</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="stat-waiting">0</span>
                        <span class="stat-label">Menunggu</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="stat-called">0</span>
                        <span class="stat-label">Dipanggil</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="stat-completed">0</span>
                        <span class="stat-label">Selesai</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="stat-counters">0</span>
                        <span class="stat-label">Loket Aktif</span>
                    </div>
                </div>
            </section>

            <section class="queue-types-section">
                <div class="section-header">
                    <h2>Jenis Antrian</h2>
                    <button class="btn btn-primary" onclick="showAddQueueTypeModal()">+ Tambah Jenis</button>
                </div>
                <div class="queue-types-grid" id="queue-types-list">
                    <!-- Queue types will be loaded here -->
                </div>
            </section>

            <section class="counters-section">
                <div class="section-header">
                    <h2>Manajemen Loket</h2>
                    <button class="btn btn-primary" onclick="showAddCounterModal()">+ Tambah Loket</button>
                </div>
                <div class="counters-grid" id="counters-list">
                    <!-- Counters will be loaded here -->
                </div>
            </section>

            <section class="settings-section">
                <div class="section-header">
                    <h2>Pengaturan Display</h2>
                </div>
                <div class="settings-card">
                    <form id="display-settings-form" onsubmit="saveSettings(event)">
                        <div class="form-group">
                            <label for="setting-video-url">Video YouTube (URL atau ID)</label>
                            <input type="text" id="setting-video-url" class="form-control" placeholder="Contoh: https://www.youtube.com/watch?v=dQw4w9WgXcQ">
                            <small>Masukkan URL lengkap atau ID video YouTube.</small>
                        </div>
                        <div class="form-group">
                            <label for="setting-running-text">Running Text</label>
                            <textarea id="setting-running-text" class="form-control" rows="3" placeholder="Masukkan teks pengumuman yang akan berjalan..."></textarea>
                        </div>
                        <div class="form-actions" style="justify-content: flex-start;">
                            <button type="submit" class="btn btn-primary">Simpan Pengaturan</button>
                        </div>
                    </form>
                </div>
            </section>

            <section class="ticket-design-section">
                <div class="section-header">
                    <h2>Desain Tiket Antrian</h2>
                </div>
                <div class="ticket-design-container">
                    <div class="ticket-design-form">
                        <form id="ticket-design-form" onsubmit="saveTicketDesign(event)">
                            <div class="form-group">
                                <label for="ticket-header">Header Tiket</label>
                                <input type="text" id="ticket-header" class="form-control" placeholder="SISTEM ANTRIAN" maxlength="32">
                                <small>Maksimal 32 karakter</small>
                            </div>
                            <div class="form-group">
                                <label for="ticket-subheader">Sub Header</label>
                                <input type="text" id="ticket-subheader" class="form-control" placeholder="KPP PRATAMA" maxlength="32">
                                <small>Nama instansi/kantor (opsional)</small>
                            </div>
                            <div class="form-group">
                                <label for="ticket-title">Judul Nomor</label>
                                <input type="text" id="ticket-title" class="form-control" placeholder="NOMOR ANTRIAN ANDA" maxlength="32">
                            </div>
                            <div class="form-group">
                                <label for="ticket-footer1">Footer Baris 1</label>
                                <input type="text" id="ticket-footer1" class="form-control" placeholder="Mohon menunggu hingga" maxlength="32">
                            </div>
                            <div class="form-group">
                                <label for="ticket-footer2">Footer Baris 2</label>
                                <input type="text" id="ticket-footer2" class="form-control" placeholder="nomor Anda dipanggil" maxlength="32">
                            </div>
                            <div class="form-group">
                                <label for="ticket-thanks">Pesan Terima Kasih</label>
                                <input type="text" id="ticket-thanks" class="form-control" placeholder="Terima kasih" maxlength="32">
                            </div>

                            <div class="form-group">
                                <label>Elemen yang Ditampilkan:</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="ticket-show-subheader" checked> Sub Header
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="ticket-show-type" checked> Jenis Layanan
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="ticket-show-datetime" checked> Tanggal & Waktu
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="ticket-show-footer" checked> Footer
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="ticket-show-thanks" checked> Pesan Terima Kasih
                                    </label>
                                </div>
                            </div>

                            <div class="form-actions" style="justify-content: flex-start; gap: 0.5rem;">
                                <button type="submit" class="btn btn-primary">Simpan Desain</button>
                                <button type="button" class="btn" onclick="testPrintTicket()">Test Print</button>
                            </div>
                        </form>
                    </div>

                    <div class="ticket-preview-container">
                        <h4>Preview Tiket</h4>
                        <div class="ticket-preview" id="ticket-preview">
                            <div class="preview-header" id="preview-header">SISTEM ANTRIAN</div>
                            <div class="preview-subheader" id="preview-subheader">KPP PRATAMA</div>
                            <div class="preview-separator">--------------------------------</div>
                            <div class="preview-title" id="preview-title">NOMOR ANTRIAN ANDA</div>
                            <div class="preview-number">A001</div>
                            <div class="preview-type" id="preview-type-label">Umum</div>
                            <div class="preview-separator">--------------------------------</div>
                            <div class="preview-datetime" id="preview-datetime">14/01/2026, 12:00:00</div>
                            <div class="preview-separator">--------------------------------</div>
                            <div class="preview-footer" id="preview-footer">
                                <div id="preview-footer1">Mohon menunggu hingga</div>
                                <div id="preview-footer2">nomor Anda dipanggil</div>
                            </div>
                            <div class="preview-thanks" id="preview-thanks">Terima kasih</div>
                        </div>
                        <small class="preview-note">Preview simulasi untuk printer thermal 80mm</small>
                    </div>
                </div>
            </section>

            <section class="queues-section">
                <div class="section-header">
                    <h2>Daftar Antrian</h2>
                </div>
                <div class="queue-filters-row">
                    <div class="filter-group">
                        <label>Status:</label>
                        <div class="status-filters">
                            <button class="btn btn-sm active" data-filter="">Semua</button>
                            <button class="btn btn-sm" data-filter="waiting">Menunggu</button>
                            <button class="btn btn-sm" data-filter="called">Dipanggil</button>
                            <button class="btn btn-sm" data-filter="completed">Selesai</button>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label for="filter-date">Tanggal:</label>
                        <input type="date" id="filter-date" class="filter-input" onchange="applyFilters()">
                    </div>
                    <div class="filter-group">
                        <label for="filter-type">Jenis:</label>
                        <select id="filter-type" class="filter-input" onchange="applyFilters()">
                            <option value="">Semua Jenis</option>
                        </select>
                    </div>
                </div>
                <div class="queues-table-container">
                    <table class="queues-table">
                        <thead>
                            <tr>
                                <th>No. Antrian</th>
                                <th>Jenis</th>
                                <th>Status</th>
                                <th>Loket</th>
                                <th>Waktu Ambil</th>
                                <th>Waktu Panggil</th>
                            </tr>
                        </thead>
                        <tbody id="queues-list">
                            <!-- Queues will be loaded here -->
                        </tbody>
                    </table>
                </div>
                <div class="pagination" id="pagination">
                    <!-- Pagination will be loaded here -->
                </div>
            </section>
        </main>
    </div>

    <!-- Add Counter Modal -->
    <div class="modal" id="add-counter-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tambah Loket Baru</h3>
                <button class="modal-close" onclick="closeModal('add-counter-modal')">&times;</button>
            </div>
            <form id="add-counter-form" onsubmit="addCounter(event)">
                <div class="form-group">
                    <label for="counter-number">Nomor Loket</label>
                    <input type="text" id="counter-number" required placeholder="1">
                </div>
                <div class="form-group">
                    <label for="counter-name">Nama Loket</label>
                    <input type="text" id="counter-name" required placeholder="Loket 1">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn" onclick="closeModal('add-counter-modal')">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Queue Type Modal -->
    <div class="modal" id="add-queue-type-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Tambah Jenis Antrian</h3>
                <button class="modal-close" onclick="closeModal('add-queue-type-modal')">&times;</button>
            </div>
            <form id="add-queue-type-form" onsubmit="addQueueType(event)">
                <div class="form-group">
                    <label for="queue-type-code">Kode</label>
                    <input type="text" id="queue-type-code" required placeholder="A" maxlength="5">
                    <small>Kode unik untuk jenis antrian (contoh: A, B, CS)</small>
                </div>
                <div class="form-group">
                    <label for="queue-type-name">Nama Layanan</label>
                    <input type="text" id="queue-type-name" required placeholder="Layanan Umum">
                </div>
                <div class="form-group">
                    <label for="queue-type-prefix">Prefix Nomor</label>
                    <input type="text" id="queue-type-prefix" required placeholder="A" maxlength="5">
                    <small>Awalan nomor antrian (contoh: A untuk A001, A002)</small>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn" onclick="closeModal('add-queue-type-modal')">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Queue Type Modal -->
    <div class="modal" id="edit-queue-type-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Jenis Antrian</h3>
                <button class="modal-close" onclick="closeModal('edit-queue-type-modal')">&times;</button>
            </div>
            <form id="edit-queue-type-form" onsubmit="updateQueueType(event)">
                <input type="hidden" id="edit-queue-type-id">
                <div class="form-group">
                    <label for="edit-queue-type-name">Nama Layanan</label>
                    <input type="text" id="edit-queue-type-name" required>
                </div>
                <div class="form-group">
                    <label for="edit-queue-type-prefix">Prefix Nomor</label>
                    <input type="text" id="edit-queue-type-prefix" required maxlength="5">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="edit-queue-type-active"> Aktif
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-danger" onclick="deleteQueueType()">Hapus</button>
                    <button type="button" class="btn" onclick="closeModal('edit-queue-type-modal')">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Reset Queues Confirmation Modal -->
    <div class="modal" id="reset-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Reset Antrian Hari Ini</h3>
                <button class="modal-close" onclick="closeModal('reset-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="warning-icon">&#9888;</div>
                <p class="warning-text"><strong>Peringatan!</strong></p>
                <p>Anda akan menghapus data antrian <strong>HARI INI</strong>:</p>

                <div class="form-group" style="text-align: left; margin-top: 1rem;">
                    <label for="reset-queue-type">Pilih Jenis Antrian:</label>
                    <select id="reset-queue-type" class="filter-input" style="width: 100%;">
                        <option value="">Semua Jenis Antrian</option>
                        <!-- Options akan diisi oleh JavaScript -->
                    </select>
                </div>

                <ul>
                    <li>Nomor antrian yang sudah diambil hari ini</li>
                    <li>Riwayat panggilan antrian hari ini</li>
                    <li>Status antrian di loket yang terkait</li>
                </ul>
                <p class="warning-text">Tindakan ini tidak dapat dibatalkan!</p>
            </div>
            <div class="form-actions">
                <button type="button" class="btn" onclick="closeModal('reset-modal')">Batal</button>
                <button type="button" class="btn btn-danger" onclick="resetQueues()">Ya, Reset</button>
            </div>
        </div>
    </div>

    <script src="/static/js/admin.js"></script>
</body>
</html>
